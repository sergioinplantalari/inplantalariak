<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contrato de Confidencialidad - Abogados Bizkaia</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h2 {
            color: #1e3c72;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        input, textarea, select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
            font-family: inherit;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .signature-pad {
            border: 2px dashed #667eea;
            border-radius: 8px;
            cursor: crosshair;
            background: #fafafa;
            margin-top: 10px;
        }

        .signature-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .signature-controls button {
            padding: 8px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .signature-controls button:hover {
            background: #667eea;
            color: white;
        }

        #contractPreview {
            display: none;
        }

        .contract-document {
            background: white;
            padding: 60px;
            line-height: 1.8;
            color: #333;
        }

        .contract-document h1 {
            text-align: center;
            color: #1e3c72;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .contract-document h2 {
            color: #1e3c72;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .contract-document p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .signatures-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-top: 60px;
        }

        .signature-box {
            text-align: center;
        }

        .signature-box img {
            max-width: 100%;
            height: auto;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }

        .signature-box p {
            font-weight: 600;
            margin: 5px 0;
            text-align: center;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .signatures-row {
                grid-template-columns: 1fr;
            }

            .contract-document {
                padding: 30px 20px;
            }

            .button-group {
                flex-direction: column;
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                border-radius: 0;
            }

            .header, .button-group {
                display: none;
            }
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #999;
            font-weight: 600;
        }

        .step.active {
            color: #667eea;
        }

        .step-number {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .step.active .step-number {
            background: #667eea;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öñÔ∏è Contrato de Confidencialidad</h1>
            <p>Sistema de Firma Digital para Abogados de Bizkaia</p>
        </div>

        <div class="content">
            <!-- FORMULARIO -->
            <div id="formSection">
                <div class="step-indicator">
                    <div class="step active">
                        <span class="step-number">1</span>
                        <span>Datos</span>
                    </div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <span>Firmas</span>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <span>Documento</span>
                    </div>
                </div>

                <div class="section">
                    <h2>üìã Datos del Abogado</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="abogadoNombre">Nombre completo *</label>
                            <input type="text" id="abogadoNombre" required>
                        </div>
                        <div class="form-group">
                            <label for="abogadoDNI">DNI *</label>
                            <input type="text" id="abogadoDNI" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="abogadoColegiado">N√∫mero de colegiado *</label>
                            <input type="text" id="abogadoColegiado" required>
                        </div>
                        <div class="form-group">
                            <label for="abogadoDespacho">Despacho/Bufete</label>
                            <input type="text" id="abogadoDespacho">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="abogadoDireccion">Direcci√≥n (Bizkaia) *</label>
                            <input type="text" id="abogadoDireccion" required>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>üë§ Datos del Cliente</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clienteNombre">Nombre completo *</label>
                            <input type="text" id="clienteNombre" required>
                        </div>
                        <div class="form-group">
                            <label for="clienteDNI">DNI/NIE *</label>
                            <input type="text" id="clienteDNI" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="clienteDireccion">Direcci√≥n *</label>
                            <input type="text" id="clienteDireccion" required>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>üìÑ Detalles del Asunto</h2>
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="asuntoDescripcion">Descripci√≥n del asunto legal *</label>
                            <textarea id="asuntoDescripcion" required placeholder="Breve descripci√≥n del caso o asunto a tratar..."></textarea>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="fechaInicio">Fecha de inicio *</label>
                            <input type="date" id="fechaInicio" required>
                        </div>
                        <div class="form-group">
                            <label for="duracionAnios">Duraci√≥n del acuerdo (a√±os) *</label>
                            <select id="duracionAnios" required>
                                <option value="1">1 a√±o</option>
                                <option value="2" selected>2 a√±os</option>
                                <option value="3">3 a√±os</option>
                                <option value="5">5 a√±os</option>
                                <option value="10">10 a√±os</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn" onclick="mostrarFirmas()">Continuar a Firmas ‚Üí</button>
                </div>
            </div>

            <!-- SECCI√ìN DE FIRMAS -->
            <div id="firmasSection" style="display: none;">
                <div class="step-indicator">
                    <div class="step">
                        <span class="step-number">‚úì</span>
                        <span>Datos</span>
                    </div>
                    <div class="step active">
                        <span class="step-number">2</span>
                        <span>Firmas</span>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <span>Documento</span>
                    </div>
                </div>

                <div class="section">
                    <h2>‚úçÔ∏è Firma del Abogado</h2>
                    <p>Por favor, firme en el recuadro a continuaci√≥n:</p>
                    <canvas id="abogadoCanvas" class="signature-pad" width="800" height="200"></canvas>
                    <div class="signature-controls">
                        <button onclick="limpiarFirma('abogado')">üóëÔ∏è Limpiar</button>
                    </div>
                </div>

                <div class="section">
                    <h2>‚úçÔ∏è Firma del Cliente</h2>
                    <p>Por favor, firme en el recuadro a continuaci√≥n:</p>
                    <canvas id="clienteCanvas" class="signature-pad" width="800" height="200"></canvas>
                    <div class="signature-controls">
                        <button onclick="limpiarFirma('cliente')">üóëÔ∏è Limpiar</button>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="volverFormulario()">‚Üê Volver</button>
                    <button class="btn" onclick="generarContrato()">Generar Contrato ‚Üí</button>
                </div>
            </div>

            <!-- PREVIEW DEL CONTRATO -->
            <div id="contractPreview">
                <div class="step-indicator">
                    <div class="step">
                        <span class="step-number">‚úì</span>
                        <span>Datos</span>
                    </div>
                    <div class="step">
                        <span class="step-number">‚úì</span>
                        <span>Firmas</span>
                    </div>
                    <div class="step active">
                        <span class="step-number">3</span>
                        <span>Documento</span>
                    </div>
                </div>

                <div class="contract-document" id="contractDocument"></div>

                <div class="button-group">
                    <button class="btn btn-secondary" onclick="volverFirmas()">‚Üê Editar Firmas</button>
                    <button class="btn" onclick="imprimirContrato()">üñ®Ô∏è Imprimir/Guardar PDF</button>
                    <button class="btn" onclick="nuevoContrato()">üìÑ Nuevo Contrato</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let abogadoCanvas, clienteCanvas;
        let abogadoCtx, clienteCtx;
        let dibujandoAbogado = false;
        let dibujandoCliente = false;

        window.onload = function() {
            abogadoCanvas = document.getElementById('abogadoCanvas');
            clienteCanvas = document.getElementById('clienteCanvas');
            abogadoCtx = abogadoCanvas.getContext('2d');
            clienteCtx = clienteCanvas.getContext('2d');

            configurarCanvas(abogadoCanvas, abogadoCtx, 'abogado');
            configurarCanvas(clienteCanvas, clienteCtx, 'cliente');

            // Establecer fecha actual
            document.getElementById('fechaInicio').valueAsDate = new Date();
        };

        function configurarCanvas(canvas, ctx, tipo) {
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';

            canvas.addEventListener('mousedown', (e) => iniciarDibujo(e, canvas, tipo));
            canvas.addEventListener('mousemove', (e) => dibujar(e, canvas, ctx, tipo));
            canvas.addEventListener('mouseup', () => detenerDibujo(tipo));
            canvas.addEventListener('mouseout', () => detenerDibujo(tipo));

            // Touch events para m√≥viles
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousedown', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(mouseEvent);
            });

            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent('mousemove', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(mouseEvent);
            });

            canvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                const mouseEvent = new MouseEvent('mouseup', {});
                canvas.dispatchEvent(mouseEvent);
            });
        }

        function iniciarDibujo(e, canvas, tipo) {
            if (tipo === 'abogado') {
                dibujandoAbogado = true;
            } else {
                dibujandoCliente = true;
            }
            const rect = canvas.getBoundingClientRect();
            const ctx = tipo === 'abogado' ? abogadoCtx : clienteCtx;
            ctx.beginPath();
            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        }

        function dibujar(e, canvas, ctx, tipo) {
            const dibujando = tipo === 'abogado' ? dibujandoAbogado : dibujandoCliente;
            if (!dibujando) return;
            const rect = canvas.getBoundingClientRect();
            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            ctx.stroke();
        }

        function detenerDibujo(tipo) {
            if (tipo === 'abogado') {
                dibujandoAbogado = false;
            } else {
                dibujandoCliente = false;
            }
        }

        function limpiarFirma(tipo) {
            if (tipo === 'abogado') {
                abogadoCtx.clearRect(0, 0, abogadoCanvas.width, abogadoCanvas.height);
            } else {
                clienteCtx.clearRect(0, 0, clienteCanvas.width, clienteCanvas.height);
            }
        }

        function mostrarFirmas() {
            // Validar campos requeridos
            const camposRequeridos = [
                'abogadoNombre', 'abogadoDNI', 'abogadoColegiado', 'abogadoDireccion',
                'clienteNombre', 'clienteDNI', 'clienteDireccion', 'asuntoDescripcion', 'fechaInicio'
            ];

            for (let campo of camposRequeridos) {
                const input = document.getElementById(campo);
                if (!input.value.trim()) {
                    input.focus();
                    alert('Por favor, complete todos los campos obligatorios (*)');
                    return;
                }
            }

            document.getElementById('formSection').style.display = 'none';
            document.getElementById('firmasSection').style.display = 'block';
        }

        function volverFormulario() {
            document.getElementById('firmasSection').style.display = 'none';
            document.getElementById('formSection').style.display = 'block';
        }

        function volverFirmas() {
            document.getElementById('contractPreview').style.display = 'none';
            document.getElementById('firmasSection').style.display = 'block';
        }

        function generarContrato() {
            // Verificar que hay firmas
            const abogadoImgData = abogadoCanvas.toDataURL();
            const clienteImgData = clienteCanvas.toDataURL();

            // Obtener datos del formulario
            const datos = {
                abogadoNombre: document.getElementById('abogadoNombre').value,
                abogadoDNI: document.getElementById('abogadoDNI').value,
                abogadoColegiado: document.getElementById('abogadoColegiado').value,
                abogadoDespacho: document.getElementById('abogadoDespacho').value,
                abogadoDireccion: document.getElementById('abogadoDireccion').value,
                clienteNombre: document.getElementById('clienteNombre').value,
                clienteDNI: document.getElementById('clienteDNI').value,
                clienteDireccion: document.getElementById('clienteDireccion').value,
                asuntoDescripcion: document.getElementById('asuntoDescripcion').value,
                fechaInicio: document.getElementById('fechaInicio').value,
                duracionAnios: document.getElementById('duracionAnios').value
            };

            const fechaObj = new Date(datos.fechaInicio + 'T00:00:00');
            const fechaFormateada = fechaObj.toLocaleDateString('es-ES', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });

            const html = `
                <h1>CONTRATO DE CONFIDENCIALIDAD</h1>
                
                <p>En Bizkaia, a ${fechaFormateada}</p>

                <h2>REUNIDOS</h2>

                <p><strong>DE UNA PARTE:</strong> ${datos.abogadoNombre}, con DNI ${datos.abogadoDNI}, 
                colegiado n√∫mero ${datos.abogadoColegiado}${datos.abogadoDespacho ? ', en representaci√≥n de ' + datos.abogadoDespacho : ''}, 
                con domicilio profesional en ${datos.abogadoDireccion}, en adelante denominado <strong>"EL ABOGADO"</strong>.</p>

                <p><strong>DE OTRA PARTE:</strong> ${datos.clienteNombre}, con DNI/NIE ${datos.clienteDNI}, 
                y domicilio en ${datos.clienteDireccion}, en adelante denominado <strong>"EL CLIENTE"</strong>.</p>

                <p>Ambas partes se reconocen mutuamente capacidad legal suficiente para suscribir el presente 
                Contrato de Confidencialidad, y a tal efecto,</p>

                <h2>EXPONEN</h2>

                <p><strong>PRIMERO.</strong> Que EL CLIENTE ha solicitado los servicios profesionales de EL ABOGADO 
                en relaci√≥n con el siguiente asunto: ${datos.asuntoDescripcion}</p>

                <p><strong>SEGUNDO.</strong> Que en el desarrollo de la relaci√≥n profesional, EL CLIENTE puede facilitar 
                a EL ABOGADO informaci√≥n confidencial, sensible o de car√°cter reservado relacionada con sus asuntos 
                personales, profesionales, comerciales o de cualquier otra √≠ndole.</p>

                <p><strong>TERCERO.</strong> Que ambas partes desean establecer las condiciones bajo las cuales dicha 
                informaci√≥n ser√° tratada, protegida y utilizada.</p>

                <p>Por todo lo anterior, las partes acuerdan formalizar el presente Contrato de Confidencialidad 
                con arreglo a las siguientes:</p>

                <h2>CL√ÅUSULAS</h2>

                <p><strong>PRIMERA. OBJETO DEL CONTRATO.</strong> El presente contrato tiene por objeto establecer 
                las obligaciones de confidencialidad que asumen ambas partes respecto a la informaci√≥n que se 
                intercambie en el marco de la relaci√≥n profesional establecida entre EL ABOGADO y EL CLIENTE.</p>

                <p><strong>SEGUNDA. DEFINICI√ìN DE INFORMACI√ìN CONFIDENCIAL.</strong> Se considera informaci√≥n 
                confidencial toda aquella informaci√≥n, datos, documentos, conocimientos, t√©cnicas, procedimientos, 
                estrategias o cualquier otro material, ya sea de car√°cter escrito, oral, gr√°fico, electr√≥nico o 
                de cualquier otra naturaleza, que se intercambie entre las partes en relaci√≥n con el asunto objeto 
                del presente contrato.</p>

                <p><strong>TERCERA. OBLIGACIONES DE CONFIDENCIALIDAD.</strong> EL ABOGADO se compromete a:</p>
                <p>a) Mantener en estricta confidencialidad toda la informaci√≥n facilitada por EL CLIENTE.</p>
                <p>b) No divulgar, comunicar o revelar dicha informaci√≥n a terceros sin el consentimiento previo 
                y expreso de EL CLIENTE, salvo cuando sea legalmente obligatorio.</p>
                <p>c) Utilizar la informaci√≥n √∫nicamente para los fines relacionados con la prestaci√≥n de sus 
                servicios profesionales.</p>
                <p>d) Adoptar las medidas de seguridad necesarias para proteger la informaci√≥n confidencial.</p>

                <p><strong>CUARTA. EXCEPCIONES.</strong> No se considerar√° incumplimiento del presente contrato 
                la revelaci√≥n de informaci√≥n cuando:</p>
                <p>a) Sea requerida por resoluci√≥n judicial o administrativa.</p>
                <p>b) Sea necesaria para el ejercicio de la defensa jur√≠dica en procedimientos judiciales o 
                administrativos.</p>
                <p>c) Sea de dominio p√∫blico sin que ello sea consecuencia de un incumplimiento del presente contrato.</p>

                <p><strong>QUINTA. PROTECCI√ìN DE DATOS.</strong> El tratamiento de datos personales se realizar√° 
                conforme a lo establecido en el Reglamento (UE) 2016/679 del Parlamento Europeo y del Consejo, 
                de 27 de abril de 2016 (RGPD), y en la Ley Org√°nica 3/2018, de 5 de diciembre, de Protecci√≥n 
                de Datos Personales y garant√≠a de los derechos digitales.</p>

                <p><strong>SEXTA. DURACI√ìN.</strong> El presente contrato tendr√° una duraci√≥n de ${datos.duracionAnios} 
                a√±o(s) desde la fecha de su firma, sin perjuicio de que las obligaciones de confidencialidad 
                subsistan una vez finalizada la relaci√≥n profesional.</p>

                <p><strong>S√âPTIMA. LEGISLACI√ìN APLICABLE Y JURISDICCI√ìN.</strong> El presente contrato se regir√° 
                por la legislaci√≥n espa√±ola. Para cualquier controversia derivada del presente contrato, las partes 
                se someten expresamente a los Juzgados y Tribunales de Bizkaia, con renuncia expresa a cualquier 
                otro fuero que pudiera corresponderles.</p>

                <p>Y en prueba de conformidad con cuanto antecede, ambas partes firman el presente Contrato de 
                Confidencialidad por duplicado ejemplar y a un solo efecto, en el lugar y fecha indicados en 
                el encabezamiento.</p>

                <div class="signatures-row">
                    <div class="signature-box">
                        <img src="${abogadoImgData}" alt="Firma del Abogado">
                        <p>${datos.abogadoNombre}</p>
                        <p>EL ABOGADO</p>
                        <p style="font-size: 0.9em; color: #666;">Colegiado N¬∫ ${datos.abogadoColegiado}</p>
                    </div>
                    <div class="signature-box">
                        <img src="${clienteImgData}" alt="Firma del Cliente">
                        <p>${datos.clienteNombre}</p>
                        <p>EL CLIENTE</p>
                        <p style="font-size: 0.9em; color: #666;">DNI/NIE: ${datos.clienteDNI}</p>
                    </div>
                </div>
            `;

            document.getElementById('contractDocument').innerHTML = html;
            document.getElementById('firmasSection').style.display = 'none';
            document.getElementById('contractPreview').style.display = 'block';
        }

        function imprimirContrato() {
            window.print();
        }

        function nuevoContrato() {
            if (confirm('¬øEst√° seguro de que desea crear un nuevo contrato? Se perder√° la informaci√≥n actual.')) {
                location.reload();
            }
        }
    </script>
</body>
</html>